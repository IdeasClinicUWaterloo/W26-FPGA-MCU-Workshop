# Display over HDMI

We use to I2C communication in this workshop for the ADV7513 HDMI encoder which is a chip on the FPGA board. This chip allows us to interface with an HDMI-enabled display. Over I2C communication, we send display data over a parallel interface (consisting of 24 bits of RGB data, horizontal and vertical sync signals, a pixel clock, and a data enable signal). 

##  Display a white screen
Now that weâ€™ve instantiated our HDMI components, we must connect its outputs with the ADV7513 HDMI encoder.

To do this, assign the output signals `hdmi_tx_de`, `hdmi_tx_hs`, `hdmi_tx_vs`, and `hdmi_tx_clk` to `de`, `hsync`, `vsync`, and `clk_pixel`, respectively in the **logic section** of the architecture body in `hdmi_top`.

````VHDL
-- wiring HDMI tx to generated video signals
hdmi_tx_de <= de;
hdmi_tx_hs <= hsync;
hdmi_tx_vs <= vsync;
hdmi_tx_clk <= clk_pixel;
hdmi_tx_d <= rgb;
````
Compile and upload your program to the board. If it is working correctly, the board should be displaying a completely white screen over HDMI. 

## Display a Test Pattern

With the HDMI system working, we will now write some logic to display a pattern over HDMI. We will use the provided `renderer` component to interface with the video timing signals and choose a color for each pixel on the display.

Navigate to `renderer` and go to down to its **process**: 

![Renderer process for white screen](assets/white_screen_process.png)

Here's an explaination of the code: 
- `hcount`: the horizontal/x position of the current pixel
- `vcount`: the vertical/y position of the current pixel
- `de`: whether we should be drawing to the screen
- `rgb`: the RGB color to draw on the pixel specified by `hcount` and `vcount`

### Write a test pattern
For this part of the project, you will write logic to display a pattern in `renderer`. Feel free to be creative and try something without knowing what the result will be. 

You can do this by replacing the line: `rgb <= x"FFFFFF";` with your test pattern. 

**Warning**: this step may produce flashing patterns that can trigger seizures for people with photosensitive epilepsy.

Some options for ways to generate the pattern include: 
- Assigning red, green, and blue values based on bits in hcount and vcount 
- Color every other pixel white, alternating colors every frame 
- Draw a checkerboard with different size squares in red, green, and blue 

In VHDL, INTEGER types cannot be indexed, so `renderer` includes two signals (`hcount_vec` and `vcount_vec`) that are STD_LOGIC_VECTOR versions of hcount and vcount.  Use these if you need to access certain bits of hcount and vcount in your test pattern logic. 

One example of a simple test pattern would be: 
````VHDL
-- logic for test pattern/choosing a color goes here
rgb(7 downto 0)   <= hcount_vec(7 downto 0); 
rgb(15 downto 8)  <= hcount_vec(9 downto 2); 
rgb(23 downto 16) <= vcount_vec(7 downto 0); 
````

Compile and upload your program to the board. If it is working correctly, the board should be displaying a test pattern similar to this: 

![Test pattern](assets/test_pattern.png)

## RTL Viewer 

It's possible to view the logic circuit generated by your VHDL code by using the RTL Viewer. It should look something like this at this stage: 

![Renderer block diagram](assets/RTL_white_screen.png)